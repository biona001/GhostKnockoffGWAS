<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Documentation · GhostKnockoffGWAS</title><meta name="title" content="Documentation · GhostKnockoffGWAS"/><meta property="og:title" content="Documentation · GhostKnockoffGWAS"/><meta property="twitter:title" content="Documentation · GhostKnockoffGWAS"/><meta name="description" content="Documentation for GhostKnockoffGWAS."/><meta property="og:description" content="Documentation for GhostKnockoffGWAS."/><meta property="twitter:description" content="Documentation for GhostKnockoffGWAS."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GhostKnockoffGWAS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../intro/">Introduction</a></li><li class="is-active"><a class="tocitem" href>Documentation</a><ul class="internal"><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Required-inputs"><span>Required inputs</span></a></li><li><a class="tocitem" href="#Optional-inputs"><span>Optional inputs</span></a></li><li><a class="tocitem" href="#Output-format"><span>Output format</span></a></li><li><a class="tocitem" href="#Acceptable-Z-scores-file-format"><span>Acceptable Z-scores file format</span></a></li><li><a class="tocitem" href="#Requirements-on-the-input-Z-scores"><span>Requirements on the input Z-scores</span></a></li></ul></li><li><a class="tocitem" href="../download/">Downloads</a></li><li><a class="tocitem" href="../examples/">Tutorial</a></li><li><a class="tocitem" href="../solveblocks/">Customizing LD files</a></li><li><a class="tocitem" href="../FAQ/">FAQ</a></li><li><a class="tocitem" href="../julia/">Usage within Julia</a></li><li><a class="tocitem" href="../developer/">Developer documentation</a></li><li><a class="tocitem" href="../gallery/">Gallery</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/biona001/GhostKnockoffGWAS" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/biona001/GhostKnockoffGWAS/blob/main/docs/src/man/documentation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Command-line-documentation-and-usage-of-GhostKnockoffGWAS"><a class="docs-heading-anchor" href="#Command-line-documentation-and-usage-of-GhostKnockoffGWAS">Command-line documentation and usage of GhostKnockoffGWAS</a><a id="Command-line-documentation-and-usage-of-GhostKnockoffGWAS-1"></a><a class="docs-heading-anchor-permalink" href="#Command-line-documentation-and-usage-of-GhostKnockoffGWAS" title="Permalink"></a></h1><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>Simple run</p><pre><code class="nohighlight hljs">GhostKnockoffGWAS --zfile example_zfile.txt --LD-files EUR --N 506200 --genome-build 38 --out example_output</code></pre><h2 id="Required-inputs"><a class="docs-heading-anchor" href="#Required-inputs">Required inputs</a><a id="Required-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Required-inputs" title="Permalink"></a></h2><table><tr><th style="text-align: left">Option name</th><th style="text-align: center">Argument</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>--zfile</code></td><td style="text-align: center">String</td><td style="text-align: left">Input file containing Z-scores as well as CHR/POS/REF/ALT. See <a href="https://biona001.github.io/GhostKnockoffGWAS/dev/man/documentation/#Acceptable-Z-scores-file-format">Acceptable Z-score files</a> for detailed requirement on this file.</td></tr><tr><td style="text-align: left"><code>--LD-files</code></td><td style="text-align: center">String</td><td style="text-align: left">Input directory to the pre-processed LD files. Most users downloads this from the <a href="https://biona001.github.io/GhostKnockoffGWAS/dev/man/download">Downloads Page</a></td></tr><tr><td style="text-align: left"><code>--N</code></td><td style="text-align: center">Int</td><td style="text-align: left">Sample size for target (original) study</td></tr><tr><td style="text-align: left"><code>--genome-build</code></td><td style="text-align: center">Int</td><td style="text-align: left">The human genome build used for SNP positions in <code>zfile</code> (this value must be 19 or 38)</td></tr><tr><td style="text-align: left"><code>--out</code></td><td style="text-align: center">String</td><td style="text-align: left">Output file name (without extensions)</td></tr></table><h2 id="Optional-inputs"><a class="docs-heading-anchor" href="#Optional-inputs">Optional inputs</a><a id="Optional-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-inputs" title="Permalink"></a></h2><table><tr><th style="text-align: left">Option name</th><th style="text-align: center">Argument</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>--CHR</code></td><td style="text-align: center">Int</td><td style="text-align: left">The column in <code>zfile</code> that will be read as chromosome number (note this must be an integer, e.g. chr22, X, chrX, ...etc are NOT acceptable). [If not specified, we will search for a column with header <code>CHR</code>]</td></tr><tr><td style="text-align: left"><code>--POS</code></td><td style="text-align: center">Int</td><td style="text-align: left">The column in <code>zfile</code> that will be read as SNP position . [If not specified, we will search for a column with header <code>POS</code>]</td></tr><tr><td style="text-align: left"><code>--REF</code></td><td style="text-align: center">Int</td><td style="text-align: left">The column in <code>zfile</code> that will be read as REF (non-effectiv) allele . [If not specified, we will search for a column with header <code>REF</code>]</td></tr><tr><td style="text-align: left"><code>--ALT</code></td><td style="text-align: center">Int</td><td style="text-align: left">The column in <code>zfile</code> that will be read as ALT (effective allele). [If not specified, we will search for a column with header <code>REF</code>]</td></tr><tr><td style="text-align: left"><code>--Z</code></td><td style="text-align: center">Int</td><td style="text-align: left">The column in <code>zfile</code> that will be read as Z-scores. [If not specified, we will search for a column with header <code>Z</code>]</td></tr><tr><td style="text-align: left"><code>--seed</code></td><td style="text-align: center">Int</td><td style="text-align: left">Sets the random seed [If not specified, defaults to <code>2023</code>]</td></tr><tr><td style="text-align: left"><code>--verbose</code></td><td style="text-align: center">Bool</td><td style="text-align: left">Whether to print intermediate messages [If not specified, defaults to <code>true</code>]</td></tr><tr><td style="text-align: left"><code>--random-shuffle</code></td><td style="text-align: center">Bool</td><td style="text-align: left">Whether to randomly permute the order of Z-scores and their knockoffs to adjust for potential ordering bias. The main purpose of this option is to take care of potential ordering bias of Lasso solvers. However, in our simulations we never observed such biases, so we turn this off by default.[If not specified, defaults to <code>false</code>]</td></tr><tr><td style="text-align: left"><code>--skip-shrinkage-check</code></td><td style="text-align: center">Bool</td><td style="text-align: left">Whether to allow Knockoff analysis to proceed even with large (&gt;0.25) LD shrinkages [If not specified, defaults to <code>false</code>]</td></tr></table><h2 id="Output-format"><a class="docs-heading-anchor" href="#Output-format">Output format</a><a id="Output-format-1"></a><a class="docs-heading-anchor-permalink" href="#Output-format" title="Permalink"></a></h2><ol><li>A summary file, e.g. <code>example_output_summary.txt</code>. This file contains broad summary of the analysis</li><li>A comma-separated file, e.g. <code>example_output.txt</code>. This file contains the full <code>GhostKnockoffGWAS</code> output, one SNP in each row.</li><li>(optional) Manhattan plots, which can be generated by following <a href="https://biona001.github.io/GhostKnockoffGWAS/dev/man/examples/#Step-5:-Generating-Manhattan-plots">step 5 of detailed example</a>.</li></ol><p>For a more detailed explanation on these 2 files, see <a href="https://biona001.github.io/GhostKnockoffGWAS/dev/man/examples/#Step-4:-Interpreting-the-result">Tutorial</a>. </p><h2 id="Acceptable-Z-scores-file-format"><a class="docs-heading-anchor" href="#Acceptable-Z-scores-file-format">Acceptable Z-scores file format</a><a id="Acceptable-Z-scores-file-format-1"></a><a class="docs-heading-anchor-permalink" href="#Acceptable-Z-scores-file-format" title="Permalink"></a></h2><p>The Z score file should satisfy the following requirements:</p><ol><li>It is a comma- or tab-separated text file (.gz compressed is acceptable)</li><li>The first row should be a header line, and every row after the first will be treated as a different SNP. </li><li>By default <code>GhostKnockoffGWAS</code> will search for column names <code>CHR</code>, <code>POS</code>, <code>REF</code>, <code>ALT</code>, and <code>Z</code>. Alternatively, you can specify which column should be used for each of these fields by providing the corresponding optional inputs, e.g. <code>--CHR 6</code> tells <code>GhostKnockoffGWAS</code> to use column 6 as <code>CHR</code>. The <code>ALT</code> allele will be treated as the effect allele and <code>REF</code> be treated as non-effect allele. The POS (position) field of each variant must be from HG19 or HG38, which must be specified by the <code>--genome-build</code> argument. </li></ol><p>Here is a minimal example with 10 Z scores</p><pre><code class="nohighlight hljs">CHR	POS	REF	ALT	Z
17	150509	T	TA	1.08773561923134
17	151035	T	C	0.703898767202681
17	151041	G	A	NaN
17	151872	T	C	-0.299877259561085
17	152087	C	T	-0.371627135786605
17	152104	G	A	-0.28387322965385
17	152248	G	A	0.901618600934489
17	152427	G	A	1.10987516000804
17	152771	A	G	0.708492545266136</code></pre><p>A toy example is <a href="https://github.com/biona001/GhostKnockoffGWAS/blob/main/data/example_zfile.txt">example_zfile.txt</a> (17MB).</p><div class="admonition is-success" id="Tip-6d020a44aad0880e"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-6d020a44aad0880e" title="Permalink"></a></header><div class="admonition-body"><p>Missing Z scores can be specified as <code>NaN</code> or as an empty cell. If you do not want a SNP to be considered in the analysis, you can change the its Z-score to NaN. CHR/POS/REF/ALT fields cannot have missing values.</p></div></div><h2 id="Requirements-on-the-input-Z-scores"><a class="docs-heading-anchor" href="#Requirements-on-the-input-Z-scores">Requirements on the input Z-scores</a><a id="Requirements-on-the-input-Z-scores-1"></a><a class="docs-heading-anchor-permalink" href="#Requirements-on-the-input-Z-scores" title="Permalink"></a></h2><p>In our papers, Z-scores are defined by <span>$z = \frac{1}{\sqrt{N}}X^ty$</span> where <span>$X$</span> is the <span>$N \times P$</span> standardized genotype matrix with <span>$N$</span> samples and <span>$P$</span> SNPs, <span>$y$</span> is the normalized <span>$n \times 1$</span> phenotype vector, and these Z-scores have <span>$N(0, 1)$</span> distribution under the null. </p><p>In practice, <a href="https://arxiv.org/abs/2310.04030">this paper</a> shows that other association test statistics that are <span>$N(0, 1)$</span> under the null also result in FDR control. This includes commonly used tests in genetic association studies such as:</p><ul><li>generalized linear mixed effect model to account for sample relatedness</li><li>saddle point approximation for extreme case-control imbalance</li><li>meta-analysis that aggregates multiple studies.</li></ul><p>If you have p-values, effect sizes, odds ratios,...etc, converting them into Z score might be possible, for example by following the <em>Notes on computing Z-scores</em> of <a href="https://huwenboshi.github.io/data%20management/2017/11/23/tips-for-formatting-gwas-summary-stats.html">this blog post</a>. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../intro/">« Introduction</a><a class="docs-footer-nextpage" href="../download/">Downloads »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Monday 23 June 2025 03:41">Monday 23 June 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
